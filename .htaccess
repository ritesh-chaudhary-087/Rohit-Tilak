# Enable rewrite engine
RewriteEngine On

# Redirect www → non-www
RewriteCond %{HTTP_HOST} ^www\.rohittilak\.com [NC]
RewriteRule ^(.*)$ https://rohittilak.com/$1 [L,R=301]

# Force HTTPS
RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://rohittilak.com/$1 [L,R=301]

# Redirect index.html → /
RewriteCond %{THE_REQUEST} /index\.html
RewriteRule ^index\.html$ https://rohittilak.com/ [L,R=301]

# If file.html exists, serve it without needing .html in URL
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.html -f
RewriteRule ^([^/]+)$ $1.html [L]

# Security: Enable HSTS
<IfModule mod_headers.c>
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
</IfModule>

# Caching rules
<IfModule mod_expires.c>
  ExpiresActive On

  # Images - cache for 1 year
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"

  # CSS, JavaScript - cache for 1 month
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"

  # HTML - cache for 1 hour
  ExpiresByType text/html "access plus 1 hour"
</IfModule>

# Gzip compression
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript application/json
</IfModule>
